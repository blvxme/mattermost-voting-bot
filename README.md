# VOTINGBOT

Необходимо добавить функционал для системы голосования внутри чатов мессенджера Mattermost. Бот должен позволять
пользователям создавать голосования, голосовать за предложенные варианты и просматривать результаты.

### Функциональные требования

- Создание голосования (бот регистрирует голосование и возвращает сообщение с ID голосования и вариантами ответов).
- Голосование (пользователь отправляет команду, указывая ID голосования и вариант ответа).
- Просмотр результатов (любой пользователь может запросить текущие результаты голосования).
- Завершение голосования (создатель голосования может завершить его досрочно).
- Удаление голосования (возможность удаления голосования).

### Нефункциональные требования

- Код должен быть написан на Go.
- Логирование действий.
- Хранение данных в Tarantool.
- Использование Docker и Docker Compose для поднятия и развертывания dev-среды.
- Код должен быть выложен на GitHub или аналог. Код должен быть сопровожден инструкцией по сборке и установке.

### Использование

- Перед началом работы убедитесь, что сервер Mattermost запущен. Для запуска сервера локально можно
  воспользоваться [официальной инструкцией](https://docs.mattermost.com/install/install-docker.html). Также необходимо
  создать аккаунт бота (можно
  воспользоваться [этой](https://developers.mattermost.com/integrate/reference/bot-accounts/) инструкцией) и добавить
  его в какую-либо организацию.
- Склонируйте данный репозиторий (`git clone git@github.com:blvxme/mattermost-voting-bot.git`) и перейдите в
  директорию (`cd mattermost-voting-bot`).
- Настройте переменные окружения. Для этого создайте файл `.env` (можно воспользоваться примером `example.env`:
  `cp example.env .env`). Для запуска бота необходимо правильно настроить следующие переменные:
    - `MATTERMOST_HOST` - имя хоста, на котором запущен сервер Mattermost;
    - `MATTERMOST_PORT` - порт, на котором запущен сервер Mattermost;
    - `MATTERMOST_TEAM` - название организации, внутри которой будет работать бот;
    - `BOT_USER` - имя, указанное во время создания аккаунта бота;
    - `BOT_TOKEN` - токен, сгенерированный после создания аккаунта бота;
    - `TARANTOOL_HOST` - имя хоста, на котором запущен Tarantool (можно оставить `localhost` при запуске через
      `docker compose up`);
    - `TARANTOOL_PORT` - порт, на котором запущен Tarantool (можно оставить `3301` при запуске через
      `docker compose up`);
    - `TARANTOOL_USER` - имя пользователя, под которым бот будет использовать Tarantool (можно оставить `votingbot` при
      запуске через `docker compose up`);
    - `TARANTOOL_PASSWORD` - пароль, который будет использован ботом для использования Tarantool (можно оставить
      `password123` при запуске через `docker compose up`).
- Наконец, можно запустить контейнеры с ботом и Tarantool (`docker compose up`).
- Теперь можно использовать бота. Для этого внутри чата организации, куда был добавлен бот, выполните одну из следующих
  команд:
    - `!voting-create "Заголовок голосования" "Вариант ответа 1" "Вариант ответа 2" ... "Вариант ответа N"` - создать
      голосование с указанным заголовком и вариантами ответов. Для этой команды необходимо **минимум** три аргумента,
      указанных внутри кавычек: заголовок голосования и два варианта ответа; например:
      `!voting-create "Заголовок голосования" "Первый вариант ответа" "Второй вариант ответа"`. После этого в ответ на
      команду бот вернет ID созданного голосования, а также указанные Вами варианты ответов.
    - `!voting-vote "ID голосования" "Выбранный вариант ответа"` - проголосовать за выбранный вариант ответа. Для этой
      команды нужно **ровно** два аргумента: ID голосования, который бот отправил при создании голосования, и выбранный
      вариант ответа. Например: `!voting-vot "aa13b6f9-5ea8-49ec-9c4b-ace92d8617b7" "Выбранный вариант ответа"`.
    - `voting-results "ID голосования"` - посмотреть результаты голосования. Указывается **ровно** один аргумент - ID
      голосования.
    - `!voting-end "ID голсования"` - завершить голосования. Голосование может завершить только пользователь, создавший
      его. Указывается **ровно** один аргумент - ID голосования. После завершения голосования проголосовать в нем больше
      не получится.
    - `!voting-delete "ID голосования"` - удалить голосование. Голосование может быть удалено только пользователем,
      создавшим его. Указывается **ровно** один аргумент - ID голосования. После удаления голосования посмотреть его
      результаты больше не получится. Голосование можно удалить только после его завершения.
